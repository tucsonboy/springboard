{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "7cf0ba4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "477ccbbe",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\tucso\\AppData\\Local\\Temp\\ipykernel_17540\\2930030131.py:1: DtypeWarning: Columns (26) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  df = pd.read_csv('C:\\Airline data\\mia_data2.csv')\n"
     ]
    }
   ],
   "source": [
    "df = pd.read_csv('C:\\Airline data\\mia_data2.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "bfe8f55d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Unnamed: 0.1', 'Unnamed: 0', 'YEAR', 'MONTH', 'DAY_OF_WEEK',\n",
       "       'OP_CARRIER_FL_NUM', 'ORIGIN', 'DEST', 'CRS_DEP_TIME', 'DEP_TIME',\n",
       "       'DEP_DELAY', 'DEP_DELAY_NEW', 'CRS_ARR_TIME', 'ARR_TIME', 'ARR_DELAY',\n",
       "       'ARR_DELAY_NEW', 'CANCELLED', 'CANCELLATION_CODE', 'DIVERTED',\n",
       "       'CRS_ELAPSED_TIME', 'ACTUAL_ELAPSED_TIME', 'CARRIER_DELAY',\n",
       "       'WEATHER_DELAY', 'NAS_DELAY', 'SECURITY_DELAY', 'LATE_AIRCRAFT_DELAY',\n",
       "       'OP_CARRIER', 'WHY_DELAY', 'DAY', 'DATE', 'DEPARTURE_TIME',\n",
       "       'ARRIVAL_TIME', 'ALL_LATE_ARR', 'ALL_LATE_DEP', 'LATE_ARR', 'LATE_DEP'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.keys()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "be74fab6",
   "metadata": {},
   "outputs": [],
   "source": [
    "# I want to create dummy values based on the why delay column\n",
    "dummy = pd.get_dummies(df['WHY_DELAY'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ed564ab4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>carrier</th>\n",
       "      <th>late aircraft</th>\n",
       "      <th>nas</th>\n",
       "      <th>security</th>\n",
       "      <th>weather</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736647</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736648</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736649</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736650</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736651</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>736652 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        0  carrier  late aircraft  nas  security  weather\n",
       "0       1        0              0    0         0        0\n",
       "1       1        0              0    0         0        0\n",
       "2       1        0              0    0         0        0\n",
       "3       1        0              0    0         0        0\n",
       "4       1        0              0    0         0        0\n",
       "...    ..      ...            ...  ...       ...      ...\n",
       "736647  1        0              0    0         0        0\n",
       "736648  1        0              0    0         0        0\n",
       "736649  1        0              0    0         0        0\n",
       "736650  0        0              0    1         0        0\n",
       "736651  0        1              0    0         0        0\n",
       "\n",
       "[736652 rows x 6 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dummy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "39b35172",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Unnamed: 0.1', 'Unnamed: 0', 'YEAR', 'MONTH', 'DAY_OF_WEEK',\n",
       "       'OP_CARRIER_FL_NUM', 'ORIGIN', 'DEST', 'CRS_DEP_TIME', 'DEP_TIME',\n",
       "       'DEP_DELAY', 'DEP_DELAY_NEW', 'CRS_ARR_TIME', 'ARR_TIME', 'ARR_DELAY',\n",
       "       'ARR_DELAY_NEW', 'CANCELLED', 'CANCELLATION_CODE', 'DIVERTED',\n",
       "       'CRS_ELAPSED_TIME', 'ACTUAL_ELAPSED_TIME', 'CARRIER_DELAY',\n",
       "       'WEATHER_DELAY', 'NAS_DELAY', 'SECURITY_DELAY', 'LATE_AIRCRAFT_DELAY',\n",
       "       'OP_CARRIER', 'WHY_DELAY', 'DAY', 'DATE', 'DEPARTURE_TIME',\n",
       "       'ARRIVAL_TIME', 'ALL_LATE_ARR', 'ALL_LATE_DEP', 'LATE_ARR', 'LATE_DEP',\n",
       "       '0', 'carrier', 'late aircraft', 'nas', 'security', 'weather'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.concat([df, dummy], axis = 1)\n",
    "df.keys()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2f45bead",
   "metadata": {},
   "outputs": [],
   "source": [
    "# I need to create two data frames to work on one that is about departures from MIA and the \n",
    "#other one that deals with arrivals.\n",
    "\n",
    "df_arr = df[df.DEST == 'MIA']\n",
    "df_dep = df[df.ORIGIN == 'MIA']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "770fd3a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Unnamed: 0.1', 'Unnamed: 0', 'YEAR', 'MONTH', 'DAY_OF_WEEK',\n",
       "       'OP_CARRIER_FL_NUM', 'ORIGIN', 'DEST', 'CRS_DEP_TIME', 'DEP_TIME',\n",
       "       'DEP_DELAY', 'DEP_DELAY_NEW', 'CRS_ARR_TIME', 'ARR_TIME', 'ARR_DELAY',\n",
       "       'ARR_DELAY_NEW', 'CANCELLED', 'CANCELLATION_CODE', 'DIVERTED',\n",
       "       'CRS_ELAPSED_TIME', 'ACTUAL_ELAPSED_TIME', 'CARRIER_DELAY',\n",
       "       'WEATHER_DELAY', 'NAS_DELAY', 'SECURITY_DELAY', 'LATE_AIRCRAFT_DELAY',\n",
       "       'OP_CARRIER', 'WHY_DELAY', 'DAY', 'DATE', 'DEPARTURE_TIME',\n",
       "       'ARRIVAL_TIME', 'ALL_LATE_ARR', 'ALL_LATE_DEP', 'LATE_ARR', 'LATE_DEP',\n",
       "       '0', 'carrier', 'late aircraft', 'nas', 'security', 'weather'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_arr.keys()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "4405ee03",
   "metadata": {},
   "outputs": [],
   "source": [
    "y = df_arr['weather']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "0187f814",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0.1</th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>YEAR</th>\n",
       "      <th>MONTH</th>\n",
       "      <th>DAY_OF_WEEK</th>\n",
       "      <th>OP_CARRIER_FL_NUM</th>\n",
       "      <th>ORIGIN</th>\n",
       "      <th>DEST</th>\n",
       "      <th>CRS_DEP_TIME</th>\n",
       "      <th>DEP_TIME</th>\n",
       "      <th>...</th>\n",
       "      <th>ARRIVAL_TIME</th>\n",
       "      <th>ALL_LATE_ARR</th>\n",
       "      <th>ALL_LATE_DEP</th>\n",
       "      <th>LATE_ARR</th>\n",
       "      <th>LATE_DEP</th>\n",
       "      <th>0</th>\n",
       "      <th>carrier</th>\n",
       "      <th>late aircraft</th>\n",
       "      <th>nas</th>\n",
       "      <th>security</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>459</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>6.0</td>\n",
       "      <td>674</td>\n",
       "      <td>STT</td>\n",
       "      <td>MIA</td>\n",
       "      <td>1535</td>\n",
       "      <td>1519.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>460</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>7.0</td>\n",
       "      <td>674</td>\n",
       "      <td>STT</td>\n",
       "      <td>MIA</td>\n",
       "      <td>1535</td>\n",
       "      <td>1550.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1535.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>461</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>674</td>\n",
       "      <td>STT</td>\n",
       "      <td>MIA</td>\n",
       "      <td>1535</td>\n",
       "      <td>1550.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18:40:00</td>\n",
       "      <td>1840.0</td>\n",
       "      <td>1535.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>462</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>674</td>\n",
       "      <td>STT</td>\n",
       "      <td>MIA</td>\n",
       "      <td>1535</td>\n",
       "      <td>1533.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>463</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>674</td>\n",
       "      <td>STT</td>\n",
       "      <td>MIA</td>\n",
       "      <td>1535</td>\n",
       "      <td>1557.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18:40:00</td>\n",
       "      <td>1840.0</td>\n",
       "      <td>1535.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736642</th>\n",
       "      <td>736642</td>\n",
       "      <td>81296</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1269</td>\n",
       "      <td>JFK</td>\n",
       "      <td>MIA</td>\n",
       "      <td>1150</td>\n",
       "      <td>1142.0</td>\n",
       "      <td>...</td>\n",
       "      <td>14:51:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736644</th>\n",
       "      <td>736644</td>\n",
       "      <td>81301</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1284</td>\n",
       "      <td>BOS</td>\n",
       "      <td>MIA</td>\n",
       "      <td>755</td>\n",
       "      <td>752.0</td>\n",
       "      <td>...</td>\n",
       "      <td>11:25:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736645</th>\n",
       "      <td>736645</td>\n",
       "      <td>81307</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1321</td>\n",
       "      <td>DTW</td>\n",
       "      <td>MIA</td>\n",
       "      <td>830</td>\n",
       "      <td>827.0</td>\n",
       "      <td>...</td>\n",
       "      <td>11:23:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736647</th>\n",
       "      <td>736647</td>\n",
       "      <td>81322</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1370</td>\n",
       "      <td>LGA</td>\n",
       "      <td>MIA</td>\n",
       "      <td>725</td>\n",
       "      <td>721.0</td>\n",
       "      <td>...</td>\n",
       "      <td>10:16:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736648</th>\n",
       "      <td>736648</td>\n",
       "      <td>81339</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1422</td>\n",
       "      <td>ATL</td>\n",
       "      <td>MIA</td>\n",
       "      <td>2225</td>\n",
       "      <td>2222.0</td>\n",
       "      <td>...</td>\n",
       "      <td>00:12:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>368286 rows Ã— 41 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Unnamed: 0.1  Unnamed: 0  YEAR  MONTH  DAY_OF_WEEK  OP_CARRIER_FL_NUM  \\\n",
       "0                  0         459  2010      5          6.0                674   \n",
       "1                  1         460  2010      5          7.0                674   \n",
       "2                  2         461  2010      5          1.0                674   \n",
       "3                  3         462  2010      5          2.0                674   \n",
       "4                  4         463  2010      5          3.0                674   \n",
       "...              ...         ...   ...    ...          ...                ...   \n",
       "736642        736642       81296  2021      9          4.0               1269   \n",
       "736644        736644       81301  2021      9          4.0               1284   \n",
       "736645        736645       81307  2021      9          4.0               1321   \n",
       "736647        736647       81322  2021      9          4.0               1370   \n",
       "736648        736648       81339  2021      9          4.0               1422   \n",
       "\n",
       "       ORIGIN DEST  CRS_DEP_TIME  DEP_TIME  ...  ARRIVAL_TIME  ALL_LATE_ARR  \\\n",
       "0         STT  MIA          1535    1519.0  ...      18:40:00           NaN   \n",
       "1         STT  MIA          1535    1550.0  ...      18:40:00           NaN   \n",
       "2         STT  MIA          1535    1550.0  ...      18:40:00        1840.0   \n",
       "3         STT  MIA          1535    1533.0  ...      18:40:00           NaN   \n",
       "4         STT  MIA          1535    1557.0  ...      18:40:00        1840.0   \n",
       "...       ...  ...           ...       ...  ...           ...           ...   \n",
       "736642    JFK  MIA          1150    1142.0  ...      14:51:00           NaN   \n",
       "736644    BOS  MIA           755     752.0  ...      11:25:00           NaN   \n",
       "736645    DTW  MIA           830     827.0  ...      11:23:00           NaN   \n",
       "736647    LGA  MIA           725     721.0  ...      10:16:00           NaN   \n",
       "736648    ATL  MIA          2225    2222.0  ...      00:12:00           NaN   \n",
       "\n",
       "        ALL_LATE_DEP  LATE_ARR  LATE_DEP  0  carrier late aircraft  nas  \\\n",
       "0                NaN       NaN       NaN  1        0             0    0   \n",
       "1             1535.0       NaN       NaN  1        0             0    0   \n",
       "2             1535.0       NaN       NaN  1        0             0    0   \n",
       "3                NaN       NaN       NaN  1        0             0    0   \n",
       "4             1535.0       NaN       NaN  1        0             0    0   \n",
       "...              ...       ...       ... ..      ...           ...  ...   \n",
       "736642           NaN       NaN       NaN  1        0             0    0   \n",
       "736644           NaN       NaN       NaN  1        0             0    0   \n",
       "736645           NaN       NaN       NaN  1        0             0    0   \n",
       "736647           NaN       NaN       NaN  1        0             0    0   \n",
       "736648           NaN       NaN       NaN  1        0             0    0   \n",
       "\n",
       "        security  \n",
       "0              0  \n",
       "1              0  \n",
       "2              0  \n",
       "3              0  \n",
       "4              0  \n",
       "...          ...  \n",
       "736642         0  \n",
       "736644         0  \n",
       "736645         0  \n",
       "736647         0  \n",
       "736648         0  \n",
       "\n",
       "[368286 rows x 41 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_arr.drop(columns = ['weather'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d6ce6364",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_arr_train, X_arr_test, y_arr_train, y_arr_test = train_test_split(df_arr, y, test_size = .33, random_state = 42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d543266e",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_dep = df_dep['weather']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "49def583",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0.1</th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>YEAR</th>\n",
       "      <th>MONTH</th>\n",
       "      <th>DAY_OF_WEEK</th>\n",
       "      <th>OP_CARRIER_FL_NUM</th>\n",
       "      <th>ORIGIN</th>\n",
       "      <th>DEST</th>\n",
       "      <th>CRS_DEP_TIME</th>\n",
       "      <th>DEP_TIME</th>\n",
       "      <th>...</th>\n",
       "      <th>ARRIVAL_TIME</th>\n",
       "      <th>ALL_LATE_ARR</th>\n",
       "      <th>ALL_LATE_DEP</th>\n",
       "      <th>LATE_ARR</th>\n",
       "      <th>LATE_DEP</th>\n",
       "      <th>0</th>\n",
       "      <th>carrier</th>\n",
       "      <th>late aircraft</th>\n",
       "      <th>nas</th>\n",
       "      <th>security</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>44</td>\n",
       "      <td>503</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>6.0</td>\n",
       "      <td>685</td>\n",
       "      <td>MIA</td>\n",
       "      <td>IAH</td>\n",
       "      <td>1450</td>\n",
       "      <td>1446.0</td>\n",
       "      <td>...</td>\n",
       "      <td>16:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>45</td>\n",
       "      <td>504</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>7.0</td>\n",
       "      <td>685</td>\n",
       "      <td>MIA</td>\n",
       "      <td>IAH</td>\n",
       "      <td>1450</td>\n",
       "      <td>1447.0</td>\n",
       "      <td>...</td>\n",
       "      <td>16:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>46</td>\n",
       "      <td>505</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>685</td>\n",
       "      <td>MIA</td>\n",
       "      <td>IAH</td>\n",
       "      <td>1450</td>\n",
       "      <td>1447.0</td>\n",
       "      <td>...</td>\n",
       "      <td>16:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>47</td>\n",
       "      <td>506</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>685</td>\n",
       "      <td>MIA</td>\n",
       "      <td>IAH</td>\n",
       "      <td>1450</td>\n",
       "      <td>1456.0</td>\n",
       "      <td>...</td>\n",
       "      <td>16:40:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1450.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>48</td>\n",
       "      <td>507</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>685</td>\n",
       "      <td>MIA</td>\n",
       "      <td>IAH</td>\n",
       "      <td>1450</td>\n",
       "      <td>1553.0</td>\n",
       "      <td>...</td>\n",
       "      <td>16:40:00</td>\n",
       "      <td>1640.0</td>\n",
       "      <td>1450.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736643</th>\n",
       "      <td>736643</td>\n",
       "      <td>81299</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1282</td>\n",
       "      <td>MIA</td>\n",
       "      <td>LGA</td>\n",
       "      <td>1730</td>\n",
       "      <td>1720.0</td>\n",
       "      <td>...</td>\n",
       "      <td>20:32:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736646</th>\n",
       "      <td>736646</td>\n",
       "      <td>81309</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1327</td>\n",
       "      <td>MIA</td>\n",
       "      <td>JFK</td>\n",
       "      <td>1510</td>\n",
       "      <td>1503.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18:14:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736649</th>\n",
       "      <td>736649</td>\n",
       "      <td>81340</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1423</td>\n",
       "      <td>MIA</td>\n",
       "      <td>MSP</td>\n",
       "      <td>1346</td>\n",
       "      <td>1339.0</td>\n",
       "      <td>...</td>\n",
       "      <td>16:27:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736650</th>\n",
       "      <td>736650</td>\n",
       "      <td>81341</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1428</td>\n",
       "      <td>MIA</td>\n",
       "      <td>ATL</td>\n",
       "      <td>806</td>\n",
       "      <td>842.0</td>\n",
       "      <td>...</td>\n",
       "      <td>09:55:00</td>\n",
       "      <td>955.0</td>\n",
       "      <td>806.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>736651</th>\n",
       "      <td>736651</td>\n",
       "      <td>81342</td>\n",
       "      <td>2021</td>\n",
       "      <td>9</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1435</td>\n",
       "      <td>MIA</td>\n",
       "      <td>ATL</td>\n",
       "      <td>1345</td>\n",
       "      <td>1431.0</td>\n",
       "      <td>...</td>\n",
       "      <td>15:38:00</td>\n",
       "      <td>1538.0</td>\n",
       "      <td>1345.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>368366 rows Ã— 41 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Unnamed: 0.1  Unnamed: 0  YEAR  MONTH  DAY_OF_WEEK  OP_CARRIER_FL_NUM  \\\n",
       "44                44         503  2010      5          6.0                685   \n",
       "45                45         504  2010      5          7.0                685   \n",
       "46                46         505  2010      5          1.0                685   \n",
       "47                47         506  2010      5          2.0                685   \n",
       "48                48         507  2010      5          3.0                685   \n",
       "...              ...         ...   ...    ...          ...                ...   \n",
       "736643        736643       81299  2021      9          4.0               1282   \n",
       "736646        736646       81309  2021      9          4.0               1327   \n",
       "736649        736649       81340  2021      9          4.0               1423   \n",
       "736650        736650       81341  2021      9          4.0               1428   \n",
       "736651        736651       81342  2021      9          4.0               1435   \n",
       "\n",
       "       ORIGIN DEST  CRS_DEP_TIME  DEP_TIME  ...  ARRIVAL_TIME  ALL_LATE_ARR  \\\n",
       "44        MIA  IAH          1450    1446.0  ...      16:40:00           NaN   \n",
       "45        MIA  IAH          1450    1447.0  ...      16:40:00           NaN   \n",
       "46        MIA  IAH          1450    1447.0  ...      16:40:00           NaN   \n",
       "47        MIA  IAH          1450    1456.0  ...      16:40:00           NaN   \n",
       "48        MIA  IAH          1450    1553.0  ...      16:40:00        1640.0   \n",
       "...       ...  ...           ...       ...  ...           ...           ...   \n",
       "736643    MIA  LGA          1730    1720.0  ...      20:32:00           NaN   \n",
       "736646    MIA  JFK          1510    1503.0  ...      18:14:00           NaN   \n",
       "736649    MIA  MSP          1346    1339.0  ...      16:27:00           NaN   \n",
       "736650    MIA  ATL           806     842.0  ...      09:55:00         955.0   \n",
       "736651    MIA  ATL          1345    1431.0  ...      15:38:00        1538.0   \n",
       "\n",
       "        ALL_LATE_DEP  LATE_ARR  LATE_DEP  0  carrier late aircraft  nas  \\\n",
       "44               NaN       NaN       NaN  1        0             0    0   \n",
       "45               NaN       NaN       NaN  1        0             0    0   \n",
       "46               NaN       NaN       NaN  1        0             0    0   \n",
       "47            1450.0       NaN       NaN  1        0             0    0   \n",
       "48            1450.0       NaN       NaN  0        1             0    0   \n",
       "...              ...       ...       ... ..      ...           ...  ...   \n",
       "736643           NaN       NaN       NaN  1        0             0    0   \n",
       "736646           NaN       NaN       NaN  1        0             0    0   \n",
       "736649           NaN       NaN       NaN  1        0             0    0   \n",
       "736650         806.0       NaN       NaN  0        0             0    1   \n",
       "736651        1345.0       NaN       NaN  0        1             0    0   \n",
       "\n",
       "        security  \n",
       "44             0  \n",
       "45             0  \n",
       "46             0  \n",
       "47             0  \n",
       "48             0  \n",
       "...          ...  \n",
       "736643         0  \n",
       "736646         0  \n",
       "736649         0  \n",
       "736650         0  \n",
       "736651         0  \n",
       "\n",
       "[368366 rows x 41 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_dep.drop(columns = ['weather'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "a81b0f15",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_dep_train, X_dep_test, y_dep_train, y_dep_test = train_test_split(df_dep, y_dep, test_size = .33, random_state = 42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c2879913",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65faefc5",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
